<% layout('../layouts/default') -%>
<% script('/js/literature-detail.js') -%>
<% script('/js/literature-comment.js') -%>

<div class="row">
  <div class="col-md-8">
    <div class="row">
      <h3><%=literature.title ? literature.title: '' %></h3>
      <div class="col-md-2">
        <img src="/img/paper.jpg" alt="160x160" class="img-thumbnail"> 
      </div>
      <div id="literature-meta" class="col-md-6">
        <dl>
          <dt>Year:</dt>
          <dd><%=literature.year %></dd>

          <dt>Authors:</dt>
          <dd><span><%=literature.authors %></span></dd>

          <% if (literature.file) { %>
          <dt>Full Text</dt>
          <dd><span title="<%=literature.file.name + ' (' + literature.file.size + ')' %>" class="file-download-btn" title="download" data-url="<%=literature.file.path %>"><img src="/img/pdf.png" alt="pdf"></span></dd>
          <% } %>

          <% if (literature.accessories) { %>
          <dt>Accessories</dt>
          <dd>
              <% var exextensions=['pdf', 'doc', 'docx', 'ppt', 'pptx', 'rar', 'zip']; %>
              <% var types=['image', 'audio', 'video']; %>
              <% for (var i = 0; i < literature.accessories.length; i++) { %>
                <% var accessory = literature.accessories[i];
                   var fileicon = 'file';
                   if (exextensions.indexOf(accessory.exextension) >= 0) {
                    fileicon = accessory.exextension;
                   } else if (types.indexOf(accessory.type) >= 0) {
                    fileicon = accessory.type;
                   }
                %>
                  <span  title="<%=accessory.name + ' (' + accessory.size + ')' %>" class="file-download-btn" data-url="<%=accessory.path %>"><img src="/img/<%=fileicon %>.png"></span>
              <% } %>
            <% } %>
          </dd>
        </dl>
      </div>

      <div id="literature-rating" class="col-md-4">
        <h5>Rating</h5>
        <% if (literature.score_avg) { %>
        <% var score = Math.floor(literature.score_avg); %>
        <% for (var i = 0; i < score; i++) {%>
           <i class='glyphicon glyphicon-star'></i>
        <% } %>
        <% for (var i = 0; i < (5 - score); i++) { %>
           <i class='glyphicon glyphicon-star-empty'></i>
        <% } %>
        <%=literature.score_avg %>
        <% } %>
        <p><%=literature.score_avg ? literature.score_count : 0 %> people rated</p>
        <br><br>
        <h5>Make Your rating</h5>
        <input type="number" data-max="5" data-min="1" value="0"  id="literature-rate-star" class="rating" />
      </div>
    </div>
    <ul class="nav nav-tabs">
      <li class="active"><a href="#abstract" data-toggle="tab">Abstract</a></li>
      <li><a href="#references" data-toggle="tab">References</a></li>
      <li><a href="#cited" data-toggle="tab">Cited By</a></li>
      <li><a href="#keywords" data-toggle="tab">Keywords</a></li>
    </ul>

    <div class="tab-content" id="literature-detail-tab">

      <div class="tab-pane fade in active well" id="abstract">
        <div><%=literature.abstract ? literature.abstract : 'No Abstract Yet!' %></div>
        <br><br>
        <% var printedKeys = ['url', 'pages', 'edition', 'publisher', 'editors', 'isbn', 'book_name', 'publication', 'volume', 'issue', 'doi', 'city', 'college'] %>
        <% for (var i = 0; i < printedKeys.length; i++) {
          if (literature.hasOwnProperty(printedKeys[i]) && literature[printedKeys[i]]) {
        %>
          <div>
            <strong><%=printedKeys[i].toUpperCase() + ': ' %></strong>
            <%=literature[printedKeys[i]] %>
          </div>
          <% } %>
        <% } %>
      </div>


      <div class="tab-pane fade well" id="references">
        <div class="checkbox-options">
          <% for (var i = 0; i < referencesType.length; i++) { %>
          <label>
            <input type="checkbox" checked value="<%=referencesType[i] %>"> <%=referencesType[i] %>
          </label>
          <% } %>
        </div>
        <div>
          <small><%=literature.references.length + ' References'%></small>
        </div>
        <ul>
          <% for (var i = 0; i < literature.references.length; i++) { %>
          <% var ref = literature.references[i]; %>
          <li data-ref-type="<%=ref.type %>">
            <% if (ref.id) { %>
            <a href="/literatures/detail/<%=ref.id %>"><%=ref.title %></a>
            <% } else { %>
            <p><%=ref.title %></p>
            <% } %>
          </li>
          <% } %>
        </ul>
      </div>


      <div class="tab-pane fade well" id="cited">
        <div class="checkbox-options">
          <% for (var i = 0; i < referencesType.length; i++) { %>
          <label>
            <input type="checkbox" checked value="<%=referencesType[i] %>"> <%=referencesType[i] %>
          </label>
          <% } %>
        </div>
        <div>
          <small><%=cited.length + ' Cited'%></small>
        </div>
        <ul>
          <% for (var i = 0; i < cited.length; i++) { %>
          <% var citedItem = cited[i]; %>
          <li data-ref-type="<%=citedItem.type %>">
            <a href="/literatures/detail/<%=citedItem.id %>"><%=citedItem.title %></a>
          </li>
          <% } %>
        </ul>
      </div>


      <div class="tab-pane fade well" id="keywords">
        <div>
          <strong>KEYWORDS: </strong>
          <%=literature.keywords ? literature.keywords : 'No Keywords Yet!' %>
        </div>
        <br>
        <div>
          <strong>tags: </strong>
          <%=literature.tags ? literature.tags : 'You can make detail comments to add tags!' %>
        </div>
      </div>
    </div>
  </div>

  <div id="brief-comments" class="col-md-4">
    <h3>Brief Conments</h3>
    <ul class="list-unstyled">
      <li>
        <a href="#" class="">
          Cyanny LIANG
        </a>
        <p class="">It's really good about cloud computing!</p>
      </li>
      <li>
        <a href="#" class="">
          Arron FENG
        </a>
        <p class="">It's really Bad paper! Dont know what it is sayins.</p>
      </li>
      <li>
        <a href="#" class="">
          Thomas ZHANG
        </a>
        <p class="">It's just OK. There's some other paper explains things better.</p>
      </li>
      <li>
        <a href="#" class="">
          Smone Else
        </a>
        <p class="">lalala, love this paper lalala~</p>
      </li>
    </ul>
    <div id="brief-comments-input">
      <textarea class="form-control" rows="3" placeholder="Add your brief comment here..."></textarea>
      <div class="pull-right">
        <a href="#" class="btn">Save Draft</a>
        <button type="button" class="btn btn-success">Submit</button>
      </div>
    </div>
  </div>
</div>

<div id="comments">
  <button class="btn btn-default pull-right" data-toggle="modal" data-target="#myComment">Add my comment</button>

  <div class="modal fade" id="myComment" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title" id="myModalLabel">Modal title</h4>
        </div>
        <div class="modal-body">
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-success">Save changes</button>
        </div>
      </div>
    </div>
  </div>

  <h3>Comments</h3>
  <div id="comments-list">
    <div class="panel-group" id="accordion">
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
            <a data-toggle="collapse" data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
              Paper Comments #1
            </a>
          </h4>
        </div>
        <div id="collapseOne" class="panel-collapse collapse in">
          <div class="panel-body">
            Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
            <a data-toggle="collapse" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
              Paper Comments #2
            </a>
          </h4>
        </div>
        <div id="collapseTwo" class="panel-collapse collapse">
          <div class="panel-body">
            Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <h4 class="panel-title">
            <a data-toggle="collapse" data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
              Paper Comments #3
            </a>
          </h4>
        </div>
        <div id="collapseThree" class="panel-collapse collapse">
          <div class="panel-body">
            Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
          </div>
        </div>
      </div>
    </div>
  </div>
  
</div>
